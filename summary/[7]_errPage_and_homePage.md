# 오류 페이지와 홈페이지 구현하기

## **오류 메시지 구현**

```
http://localhost:3000/favicon.ico
```

위와 같이 현재 Node.js 애플리케이션에 존재하지 않는, 다른 경로로 들어 왔을 때는 **파일을 찾을 수 없다**라는 오류 메시지를 전송해야한다.

### **이를 위해서는 사용자가 루트로 접속했는지 아닌지를 먼저 알아야 한다.**

---

## 루트 (Root)

루트란 **뒤에 다른 경로가 붙지 않은 주소**를 의미한다.

### [루트인 주소]

```
http://localhost:3000/      ->      다른 경로가 붙지 않은 상태 (Root)
```

```
http://localhost:3000/      ->      쿼리 스트링이 붙었을 뿐, 루트 상태이다.
```

### [루트가 아닌 주소]

아래와 같은 URL들은 **루트 주소 뒤에 다른 경로가 붙었기 때문**에 루트가 아니다.

```
http://localhost:3000/favicon.ico
```
```
http://localhost:3000/html
```

### [사용자가 요청한 URL이 루트인지 아닌지 확인하는 방법]

```javascript
var url = require('url');

var _url = request.url;

var pathname = url.parse(_url, true).pathname
```

위와 같이 url을 파싱한 결과에서 `pathname`만을 가져와서 루트인지 아닌지를 판단한다.
- `path` : 쿼리 스트링이 포함된 경로
- `pathname` : 쿼리 스트링을 제외한 **경로의 이름만**

---

이제 전체적인 Node.js 애플리케이션의 구조를 아래와 같이 바꾸어 루트인 경우와 아닌 경우를 분리하여 처리할 수 있도록 하자.

```javascript
if(pathname === '/') {
    // 루트라면 기존 코드를 실행
    // ...
} else {
    // 루트가 아니라면 새로운 코드(오류 메시지 전송) 코드를 실행
    response.writeHead(404);
    response.end('Not found');
}
```

이때 `respose.writeHead()`에서 함께 전달하는 코드는
> 웹 서버가 웹 브라우저에 전달하는 약속된 응답 코드 이다.

    > 200 : 정상
    > 300번 대 : 리다이렉팅에 대한 코드
    > 302 : 웹 페이지 리다이렉팅
    > 404 : 오류 메시지

---

## **홈페이지 구현**

홈페이지인 경우와 세부 내용에 대한 페이지인 경우는 **쿼리 스트링의 유무**에 따라서 구분할 수 있다.
> 즉, 쿼리 스트링이 없다면 홈페이지, 없다면 세부 내용에 대한 페이지인 것이다.

    queryData.id를 사용하여 구분하자

즉 전체적인 애플리케이션의 구조가 다음과 같아 질 것이다.

```javascript
if(pathname === '/') {
    if(queryData.id === undefined) {
        // 홈페이지 인 경우
        // ...
    } else {
        // 세부 내용에 대한 페이지 인 경우
        // ...
    }
} else {
    // 루트가 아닌 경우 (없는 페이지에 대한 오류 메시지)
}
```